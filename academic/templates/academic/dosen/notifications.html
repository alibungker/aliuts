{% extends 'academic/base.html' %}

{% block title %}Notifikasi{% endblock %}

{% block content %}
<style>
    .page-header { background: linear-gradient(135deg, #00c7be 0%, #00d4cc 100%); color: white; padding: 60px 0; margin: -40px 0 40px 0; border-radius: 0 0 40px 40px; box-shadow: 0 10px 40px rgba(0, 199, 190, 0.3); }
    .page-header h1 { font-size: 42px; font-weight: 600; margin-bottom: 10px; }
    .page-header p { font-size: 19px; opacity: 0.9; }
    .back-btn { display: inline-flex; align-items: center; gap: 8px; color: white; text-decoration: none; font-size: 16px; margin-bottom: 20px; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 980px; transition: all 0.3s ease; }
    .back-btn:hover { background: rgba(255,255,255,0.3); }
    
    .notifications-container { max-width: 900px; margin: 0 auto; }
    .notification-card { background: white; border-radius: 20px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); padding: 24px; margin-bottom: 20px; transition: all 0.3s ease; }
    .notification-card:hover { box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12); }
    
    .notification-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px; }
    .notification-title { font-size: 20px; font-weight: 600; color: #1d1d1f; margin: 0; }
    .notification-badge { padding: 6px 14px; border-radius: 980px; font-size: 13px; font-weight: 600; }
    .badge-pending { background: #fff3cd; color: #856404; }
    .badge-approved { background: #d4edda; color: #155724; }
    .badge-rejected { background: #f8d7da; color: #721c24; }
    .badge-info { background: #d1ecf1; color: #0c5460; }
    
    .notification-message { font-size: 15px; color: #6e6e73; line-height: 1.6; margin-bottom: 16px; }
    .notification-meta { display: flex; gap: 20px; font-size: 14px; color: #86868b; margin-bottom: 20px; }
    .notification-meta-item { display: flex; align-items: center; gap: 6px; }
    
    .notification-actions { display: flex; gap: 12px; }
    .btn { padding: 12px 24px; border-radius: 980px; font-size: 15px; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.3s ease; border: none; cursor: pointer; }
    .btn-approve { background: #30d158; color: white; }
    .btn-approve:hover { background: #28c04d; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(48, 209, 88, 0.3); }
    .btn-reject { background: #ff3b30; color: white; }
    .btn-reject:hover { background: #e6342a; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(255, 59, 48, 0.3); }
    
    .empty-state { text-align: center; padding: 80px 20px; }
    .empty-state-icon { width: 80px; height: 80px; background: #f5f5f7; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; }
    .empty-state-icon svg { width: 40px; height: 40px; stroke: #86868b; }
    .empty-state h2 { font-size: 24px; font-weight: 600; color: #1d1d1f; margin-bottom: 8px; }
    .empty-state p { font-size: 16px; color: #86868b; }
    
    @media (max-width: 768px) { .notification-header { flex-direction: column; gap: 12px; } .notification-actions { flex-direction: column; } }
</style>

<div class="page-header">
    <div class="container">
        <a href="{% url 'dosen_dashboard' %}" class="back-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"></path>
            </svg>
            Kembali
        </a>
        <h1>Notifikasi</h1>
        <p>Kelola notifikasi dan pengajuan KRS</p>
    </div>
</div>

<div class="container">
    <div class="notifications-container">
        {% if notifications %}
            {% for notification in notifications %}
            <div class="notification-card">
                <div class="notification-header">
                    <h3 class="notification-title">{{ notification.title }}</h3>
                    {% if notification.notification_type == 'krs_pending' %}
                        <span class="notification-badge badge-pending">Pending</span>
                    {% elif notification.notification_type == 'krs_approved' %}
                        <span class="notification-badge badge-approved">Disetujui</span>
                    {% elif notification.notification_type == 'krs_rejected' %}
                        <span class="notification-badge badge-rejected">Ditolak</span>
                    {% else %}
                        <span class="notification-badge badge-info">Info</span>
                    {% endif %}
                </div>
                
                <p class="notification-message">{{ notification.message }}</p>
                
                <div class="notification-meta">
                    <div class="notification-meta-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 6v6l4 2"></path>
                        </svg>
                        {{ notification.created_at|date:"d M Y, H:i" }}
                    </div>
                    {% if notification.krs %}
                    <div class="notification-meta-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                        </svg>
                        {{ notification.krs.kelas.mata_kuliah.nama_mk }}
                    </div>
                    {% endif %}
                </div>
                
                {% if notification.notification_type == 'krs_pending' and notification.krs.status == 'pending' %}
                <div class="notification-actions">
                    <form method="POST" action="{% url 'dosen_approve_krs' notification.krs.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-approve">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 13l4 4L19 7"></path>
                            </svg>
                            Setujui
                        </button>
                    </form>
                    <form method="POST" action="{% url 'dosen_reject_krs' notification.krs.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-reject">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 6L6 18M6 6l12 12"></path>
                            </svg>
                            Tolak
                        </button>
                    </form>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                </div>
                <h2>Tidak ada notifikasi</h2>
                <p>Anda belum memiliki notifikasi saat ini</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
